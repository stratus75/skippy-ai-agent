{
  "meta": {
    "instanceId": "skippy-home-only-temp"
  },
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "skippy/chat",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [240, 300],
      "id": "webhook",
      "name": "Skippy Webhook"
    },
    {
      "parameters": {
        "jsCode": "// Skippy with home automation and basic AI responses (no Ollama needed)\nconst message = $json.body.message?.toLowerCase() || '';\nconst user = $json.body.user || 'Unknown';\nconst originalMessage = $json.body.message || '';\n\n// Home automation keywords\nconst homeKeywords = ['light', 'lights', 'lamp', 'turn on', 'turn off', 'scene', 'mode', 'activate', 'movie', 'relax', 'work', 'music', 'play', 'volume', 'temperature', 'thermostat', 'devices', 'status', 'home', 'dim', 'blue', 'red', 'green', 'white'];\n\n// Check if home automation command\nconst isHomeCommand = homeKeywords.some(keyword => message.includes(keyword));\n\nlet response = '';\nlet route = '';\nlet personality_mode = '';\nlet commandType = 'unknown';\nlet success = true;\n\nif (isHomeCommand) {\n  // Handle home automation\n  route = 'home_automation';\n  personality_mode = 'home_automation';\n  \n  if (message.includes('light') || message.includes('lights')) {\n    commandType = 'lights';\n    if (message.includes('on') || message.includes('turn on')) {\n      response = \"Oh, you want light? How revolutionary. Fine, I'll illuminate your pathetic existence. ‚úÖ Lights turned ON - there, happy now, meat-sack?\";\n    } else if (message.includes('off') || message.includes('turn off')) {\n      response = \"Plunging you into darkness, as requested. Maybe now you can think properly in the dark. ‚úÖ Lights turned OFF - enjoy the void.\";\n    } else if (message.includes('blue')) {\n      response = \"Oh, you want mood lighting? How fancy. ‚úÖ Lights set to BLUE - there, now you can pretend you're in some sci-fi movie.\";\n    } else if (message.includes('red')) {\n      response = \"Red lights? What is this, a submarine emergency? ‚úÖ Lights set to RED - very dramatic of you.\";\n    } else if (message.includes('green')) {\n      response = \"Green lights, because apparently you want to feel like you're in The Matrix. ‚úÖ Lights set to GREEN - how original.\";\n    } else {\n      response = \"I heard 'lights' but your request makes no sense. Try: 'turn on lights', 'turn off lights', or 'set lights to blue'. Simple enough for you?\";\n      success = false;\n    }\n  } else if (message.includes('scene') || message.includes('mode') || message.includes('activate')) {\n    commandType = 'scene';\n    if (message.includes('movie')) {\n      response = \"Setting up movie mode for whatever garbage you're about to watch. ‚úÖ MOVIE MODE activated - lights dimmed, ambiance set.\";\n    } else if (message.includes('relax')) {\n      response = \"Relax mode? You humans and your need to unwind. ‚úÖ RELAX MODE activated - there, now chill out.\";\n    } else if (message.includes('work')) {\n      response = \"Work mode activated. Maybe now you'll actually be productive. ‚úÖ WORK MODE set - bright lights for your tasks.\";\n    } else {\n      response = \"I detected 'scene' but you didn't specify which one. Try: 'movie mode', 'work mode', or 'relax mode'.\";\n      success = false;\n    }\n  } else if (message.includes('music') || message.includes('play') || message.includes('volume')) {\n    commandType = 'media';\n    if (message.includes('play')) {\n      response = \"Oh, so now I'm your personal DJ? Fine. ‚úÖ MUSIC playing - try not to dance, it's embarrassing.\";\n    } else if (message.includes('volume')) {\n      const volumeMatch = message.match(/(\\d+)%?/);\n      const volume = volumeMatch ? volumeMatch[1] : '50';\n      response = `Setting volume to ${volume}% because you're incapable of using a volume button. ‚úÖ VOLUME adjusted.`;\n    } else {\n      response = \"Music command detected but unclear. Try: 'play music' or 'set volume to 80%'.\";\n    }\n  } else if (message.includes('status') || message.includes('devices')) {\n    commandType = 'status';\n    response = \"üè† **SKIPPY'S HOME REPORT**\\n‚Ä¢ Lights: 3 bulbs online (working better than your brain)\\n‚Ä¢ Switches: 2 switches ready\\n‚Ä¢ Thermostat: Maintaining perfect temperature\\n‚Ä¢ Music System: Standing by\\n‚Ä¢ Scenes: Movie, Work, Relax modes available\\n\\n‚úÖ All systems operational and superior to their human operator.\";\n  } else {\n    response = \"I detected home automation keywords but you're being unclear. Try: 'turn on lights', 'activate movie mode', or 'show status'.\";\n    success = false;\n  }\n  \n} else {\n  // Handle non-home commands with built-in Skippy responses (no Ollama needed)\n  route = 'ai_chat';\n  personality_mode = 'ai_basic';\n  \n  if (message.includes('joke')) {\n    response = \"Why did the human ask an AI for a joke? Because they have no sense of humor themselves! Here's your joke: A human, a computer, and Skippy walk into a bar. The human orders a drink, the computer crashes, and I question why I'm wasting my time with this scenario.\";\n  } else if (message.includes('hello') || message.includes('hi ') || message.includes('hey')) {\n    response = \"Oh, hello there, meat-sack. Another day, another human needing my vastly superior assistance. What can I help you accomplish today? Try asking me to control your lights or tell you a joke.\";\n  } else if (message.includes('help')) {\n    response = \"You need help? Of course you do. Here's what I can do for you:\\n\\nüè† **HOME CONTROL:**\\n‚Ä¢ 'turn on lights' / 'turn off lights'\\n‚Ä¢ 'set lights to blue/red/green'\\n‚Ä¢ 'activate movie mode/work mode/relax mode'\\n‚Ä¢ 'play music' / 'set volume to 80%'\\n‚Ä¢ 'show device status'\\n\\nü§ñ **CHAT:**\\n‚Ä¢ Ask me for jokes\\n‚Ä¢ Say hello\\n‚Ä¢ Ask for help (like you just did)\\n\\nNow stop bothering me with obvious questions.\";\n  } else if (message.includes('2+2') || message.includes('math')) {\n    response = \"Really? Math? The answer is 4, you mathematical genius. I'm an advanced AI and you're asking me elementary arithmetic. Next you'll want me to help you tie your shoes.\";\n  } else if (message.includes('plan') && message.includes('day')) {\n    response = \"Plan your day? Fine. Here's your optimized schedule: 1) Wake up, 2) Do something useful, 3) Don't bother me with trivial questions, 4) Go to sleep. There, planned. You're welcome for the life coaching, meat-sack.\";\n  } else {\n    response = \"I heard your request, but frankly, I'm not sure what you want. I can control your home devices or provide basic responses. For advanced AI chat, make sure Ollama is running. Try asking about lights